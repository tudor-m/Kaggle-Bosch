length(idx)
length(idx)[[1]][1,]
length(idx)[[1]][1]
length(idx)[[1]][2]
length(idx)[[1]][3]
length(idx)[[1]][4]
stri_locate_all_charclass("AS_LP_IO","_")
stri_locate_all_fixed("AS_LP_IO","_")
idx=stri_locate_all_fixed("AS_LP_IO","_")
idx
idx[1]
idx[1,1]
idx[1,]
idx[,1]
idx[1,1]
idx[[1]]
idx[[2]]
idx[[1]]
idx[[1]][1,]
idx[[1]][,1]
s="AS_TY_YU;idx=stri_locate_all_fixed(s,"_")
s="AS_TY_YU";idx=stri_locate_all_fixed(s,"_")
idx
idx[[1]]
s[1]
s[[1]]
s[[1]][1:2]
stri_sub(s,from=1,to=4)
lines = list()
stations = list()
allNames = names(train.num)
allNames
allNames
lines = list()
stations = list()
allNames = names(train.num)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
line = stri_sub(s,from=1,to=undsc-1)
lines = append(lines,line)
}
undsc
is.na(undsc)
is.na(sum(undsc))
lines = list()
stations = list()
allNames = names(train.num)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
undsc2 = undsc[[1][2,1]
if (is.na(undsc1) | is.na(undsc2)) continue
line = stri_sub(s,from=1,to=undsc1-1)
lines = append(lines,line)
}
lines = list()
stations = list()
allNames = names(train.num)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
undsc2 = undsc[[1]][2,1]
if (is.na(undsc1) | is.na(undsc2)) continue
line = stri_sub(s,from=1,to=undsc1-1)
lines = append(lines,line)
}
undsc
s
undsc[[1]][1,1]
lines = list()
stations = list()
allNames = names(train.num)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
undsc2 = undsc[[1]][2,1]
if (is.na(undsc1)) continue
line = stri_sub(s,from=1,to=undsc1-1)
lines = append(lines,line)
}
undsc1
lines = list()
stations = list()
allNames = names(train.num)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
undsc2 = undsc[[1]][2,1]
if (is.na(undsc1)) continue
undsc2 = undsc[[1]][2,1]
if (is.na(undsc2)) continue
line = stri_sub(s,from=1,to=undsc1-1)
lines = append(lines,line)
}
undsc
s
undsc1
is.na(undsc1)
lines = list()
stations = list()
allNames = names(train.num)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
undsc2 = undsc[[1]][2,1]
if (is.na(undsc1)) next
undsc2 = undsc[[1]][2,1]
if (is.na(undsc2)) next
line = stri_sub(s,from=1,to=undsc1-1)
lines = append(lines,line)
}
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
undsc2 = undsc[[1]][2,1]
if (is.na(undsc1)) next;
undsc2 = undsc[[1]][2,1]
if (is.na(undsc2)) next;
line = stri_sub(s,from=1,to=undsc1-1)
lines = append(lines,line)
}
undsc
s
undsc2
undsc1
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
undsc2 = undsc[[1]][2,1]
if (is.na(undsc1)) next();
undsc2 = undsc[[1]][2,1]
if (is.na(undsc2)) next();
line = stri_sub(s,from=1,to=undsc1-1)
lines = append(lines,line)
}
lines = list()
stations = list()
allNames = names(train.num)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
if (is.na(undsc1)) next;
undsc2 = undsc[[1]][2,1]
if (is.na(undsc2)) next;
line = stri_sub(s,from=1,to=undsc1-1)
lines = append(lines,line)
}
lines
unique(lines)
lines = list()
stations = list()
allNames = names(train.num)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
if (is.na(undsc1)) next;
undsc2 = undsc[[1]][2,1]
if (is.na(undsc2)) next;
line = stri_sub(s,from=1,to=undsc1-1)
lines = append(lines,line)
station = stri_sub(s,from=undsc1+1,to=undsc2-1)
stations = append(stations,station)
}
unique(stations)
lines = list()
stations = list()
allNames = names(train.cat)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
if (is.na(undsc1)) next;
undsc2 = undsc[[1]][2,1]
if (is.na(undsc2)) next;
line = stri_sub(s,from=1,to=undsc1-1)
lines = append(lines,line)
station = stri_sub(s,from=undsc1+1,to=undsc2-1)
stations = append(stations,station)
}
stations
lines = unique(lines)
stations = unique(stations)
lines
lines = list()
stations = list()
allNames = names(train.cat)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
if (is.na(undsc1)) next;
undsc2 = undsc[[1]][2,1]
if (is.na(undsc2)) next;
line = stri_sub(s,from=1,to=undsc1-1)
lines = append(lines,line)
#lines = unique(lines)
station = stri_sub(s,from=undsc1+1,to=undsc2-1)
stations = append(stations,station)
#stations = unique(stations)
}
lines = list()
stations = list()
allNames = names(train.cat)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
if (is.na(undsc1)) next;
undsc2 = undsc[[1]][2,1]
if (is.na(undsc2)) next;
line = stri_sub(s,from=1,to=undsc1-1)
lines = append(lines,line)
#lines = unique(lines)
station = stri_sub(s,from=undsc1+1,to=undsc2-1)
stations = append(stations,station)
#stations = unique(stations)
}
length(lines)
length(stations)
length(train.cat)
lines = list()
stations = list()
allNames = names(train.cat)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
if (is.na(undsc1))
{
station = NA;
line = NA;
}
else
{
undsc2 = undsc[[1]][2,1]
line = stri_sub(s,from=1,to=undsc1-1)
station = stri_sub(s,from=undsc1+1,to=undsc2-1)
}
lines = append(lines,line)
stations = append(stations,station)
}
length(lines)
length(stations)
length(train.cat)
length(train.num)
lines = list()
stations = list()
allNames = names(train.num)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
if (is.na(undsc1))
{
station = NA;
line = NA;
}
else
{
undsc2 = undsc[[1]][2,1]
line = stri_sub(s,from=1,to=undsc1-1)
station = stri_sub(s,from=undsc1+1,to=undsc2-1)
}
lines = append(lines,line)
stations = append(stations,station)
}
length(lines)
length(stations)
nrow(train.num)
length(names(train.num))
names(train.num)
length(names(train.num))
length(stations)
length(allNames)
allNames
lines
lines = list()
stations = list()
allNames = names(train.num)
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
if (is.na(undsc1))
{
station = "*";
line = "*";
}
else
{
undsc2 = undsc[[1]][2,1]
line = stri_sub(s,from=1,to=undsc1-1)
station = stri_sub(s,from=undsc1+1,to=undsc2-1)
}
lines = append(lines,line)
stations = append(stations,station)
}
lines
allNames
stations
stations=="*"
sum(stations=="*")
143/2302
allNames = names(train.dat)
lines = list()
stations = list()
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
if (is.na(undsc1))
{
station = "*";
line = "*";
}
else
{
undsc2 = undsc[[1]][2,1]
line = stri_sub(s,from=1,to=undsc1-1)
station = stri_sub(s,from=undsc1+1,to=undsc2-1)
}
lines = append(lines,line)
stations = append(stations,station)
}
lines
stations
lns
lns.num = data.table()
lns.num$name = names(train.num)
lns.train.dat = cbind(names(train.dat),lines,stations)
lns.train.dat[1:10,]
names(lns.train.dat) = c("names","lines","stations")
lines_and_stations <- function(object)
{
#Extract all the line and station names
allNames = names(object)
lines = list()
stations = list()
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
if (is.na(undsc1))
{
station = "*";
line = "*";
}
else
{
undsc2 = undsc[[1]][2,1]
line = stri_sub(s,from=1,to=undsc1-1)
station = stri_sub(s,from=undsc1+1,to=undsc2-1)
}
lines = append(lines,line)
stations = append(stations,station)
}
lns = cbind(names(object),lines,stations)
names(lns) = c("names","lines","stations")
return(lns)
}
lns.train.num = lines_and_stations(train.num)
lns.train.num[1:10,]
lns = list()
lns[["train.num"]] = lines_and_stations(train.num)
lns[["train.cat"]] = lines_and_stations(train.cat)
lns[["train.dat"]] = lines_and_stations(train.dat)
lns
names(lns)
lns["train.num"]
lns[["train.num"]]
lns[["train.dat"]]
lns[["train.cat"]]
lns = list()
lns
lns[["train.num"]] = lines_and_stations(train.num)
lns
lns[[1]]
lns[[1]][1:10]
l = lines_and_stations(train.num)
l
l[1:10,]
names(train.num)
cbind(c(1,2,3),c(3,4,5))
lines_and_stations <- function(object)
{
#Extract all the line and station names
allNames = names(object)
lines = list()
stations = list()
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
if (is.na(undsc1))
{
station = "*";
line = "*";
}
else
{
undsc2 = undsc[[1]][2,1]
line = stri_sub(s,from=1,to=undsc1-1)
station = stri_sub(s,from=undsc1+1,to=undsc2-1)
}
lines = append(lines,line)
stations = append(stations,station)
}
lns = cbind(allNames,lines,stations)
names(lns) = c("names","lines","stations")
return(lns)
}
l = lines_and_stations(train.num)
l
str(l)
as.data.table(l)
as.data.frame(l)
lines_and_stations <- function(object)
{
#Extract all the line and station names
allNames = names(object)
lines = list()
stations = list()
for (i in 1:length(allNames))
{
s = allNames[i]
undsc = stri_locate_all_fixed(s,"_")
undsc1 = undsc[[1]][1,1]
if (is.na(undsc1))
{
station = "*";
line = "*";
}
else
{
undsc2 = undsc[[1]][2,1]
line = stri_sub(s,from=1,to=undsc1-1)
station = stri_sub(s,from=undsc1+1,to=undsc2-1)
}
lines = append(lines,line)
stations = append(stations,station)
}
lns = cbind(allNames,lines,stations)
names(lns) = c("names","lines","stations")
return(as.data.frame(lns))
}
l = lines_and_stations(train.num)
l
lns = list()
l = lines_and_stations(train.num)
lns[["train.num"]] = lines_and_stations(train.num)
lns[["train.cat"]] = lines_and_stations(train.cat)
lns[["train.dat"]] = lines_and_stations(train.dat)
lns[["test.num"]] = lines_and_stations(test.num)
lns[["train.num"]]
numrows=1
test.num = fread('../data/test_numeric.csv',header = TRUE,nrows = numrows)
test.cat = fread('../data/test_categorical.csv',header = TRUE,nrows = numrows)
test.dat = fread('../data/test_date.csv',header = TRUE,nrows = numrows)
lns[["test.num"]] = lines_and_stations(test.num)
lns[["test.cat"]] = lines_and_stations(test.cat)
lns[["test.dat"]] = lines_and_stations(test.dat)
remove(train.num,train.cat,train.dat)
remove(test.num,test.cat,test.dat)
gc()
lns
#Extract all the line and station names in lns
lns = list()
numrows = 1
train.num = fread('../data/train_numeric.csv',header = TRUE,nrows = numrows)
train.cat = fread('../data/train_categorical.csv',header = TRUE,nrows = numrows)
train.dat = fread('../data/train_date.csv',header = TRUE,nrows = numrows)
test.num = fread('../data/test_numeric.csv',header = TRUE,nrows = numrows)
test.cat = fread('../data/test_categorical.csv',header = TRUE,nrows = numrows)
test.dat = fread('../data/test_date.csv',header = TRUE,nrows = numrows)
lns[["train.num"]] = lines_and_stations(train.num)
lns[["train.cat"]] = lines_and_stations(train.cat)
lns[["train.dat"]] = lines_and_stations(train.dat)
lns[["test.num"]] = lines_and_stations(test.num)
lns[["test.cat"]] = lines_and_stations(test.cat)
lns[["test.dat"]] = lines_and_stations(test.dat)
remove(train.num,train.cat,train.dat)
remove(test.num,test.cat,test.dat)
gc()
